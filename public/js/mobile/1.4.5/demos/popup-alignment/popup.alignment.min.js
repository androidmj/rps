(function(e,g){var f,h=e.mobile.popup.handleLink;e.mobile.popup.handleLink=function(a){f=a;return h.apply(this,arguments)};e.widget("mobile.popup",e.mobile.popup,{options:{align:"0.5,0.5"},open:function(a){this._ui.link=f;return this._super(a)},_closePrereqsDone:function(){this._ui.link=null;this._superApply(arguments)},_alignmentToCoeffs:function(a){return{originCoeff:0>a?0:1>=a?a:1,popupCoeff:0>a?a:1>=a?-a:a-2}},_getAlignment:function(){var a,b;this.options.align&&(a=this.options.align.split(","));
a&&0<a.length&&(b={x:parseFloat(a[0]),y:1<a.length?parseFloat(a[1]):b.x});if(b&&!isNaN(b.x)&&!isNaN(b.y))return{x:this._alignmentToCoeffs(b.x),y:this._alignmentToCoeffs(b.y)}},_setOptions:function(a){this._super(a);if(this._isOpen&&a.align!==g&&null!==this._ui.link&&("origin"===this._ui.link.jqmData("position-to")||"origin"===this.options.positionTo)){var b=this._ui.link.offset();a=this._ui.link.outerWidth();var c=this._ui.link.outerHeight();this._reposition({x:b.left+a/2,y:b.top+c/2,positionTo:"origin"})}},
_alignedCoord:function(a,b,c,d){return a+b.originCoeff*c+b.popupCoeff*d+d/2},_desiredCoords:function(a){var b=this._getAlignment();if(b&&"origin"===a.positionTo&&this._ui.link){var c=this._clampPopupWidth(!0);c.menuSize.cx=Math.min(c.menuSize.cx,c.rc.cx);var d=this._ui.link.offset();var e=d.left;d=d.top;var f=this._ui.link.outerWidth();var g=this._ui.link.outerHeight();a.x=this._alignedCoord(e,b.x,f,c.menuSize.cx);a.y=this._alignedCoord(d,b.y,g,c.menuSize.cy)}return this._super(a)}})})(jQuery);
