(function(f,F){function n(a){return"number"===typeof a}function p(a){return a!==G&&null!==a}var G,t=f.Chart,x=f.extend,u=f.each;var H=["path","rect","circle"];var v={top:0,left:0,center:.5,middle:.5,bottom:1,right:1};var y=F.inArray,D=f.merge,E=function(){this.init.apply(this,arguments)};E.prototype={init:function(a,d){var c=d.shape&&d.shape.type;this.chart=a;var b={xAxis:0,yAxis:0,title:{style:{},text:"",x:0,y:0},shape:{params:{stroke:"#000000",fill:"transparent",strokeWidth:2}}};a={circle:{params:{x:0,
y:0}}};a[c]&&(b.shape=D(b.shape,a[c]));this.options=D({},b,d)},render:function(a){var d=this.chart,c=this.chart.renderer,b=this.group,q=this.title,e=this.shape,h=this.options,f=h.title,m=h.shape;b||(b=this.group=c.g());!e&&m&&-1!==y(m.type,H)&&(e=this.shape=c[h.shape.type](m.params),e.add(b));!q&&f&&(q=this.title=c.label(f),q.add(b));b.add(d.annotations.group);this.linkObjects();!1!==a&&this.redraw()},redraw:function(){var a=this.options,d=this.chart,c=this.group,b=this.title,q=this.shape,e=this.linkedObject,
h=d.xAxis[a.xAxis],z=d.yAxis[a.yAxis],m=a.width,A=a.height,B=v[a.anchorY],C=v[a.anchorX];if(e){var k=e instanceof f.Point?"point":e instanceof f.Series?"series":null;if("point"===k){a.xValue=e.x;a.yValue=e.y;var r=e.series}else"series"===k&&(r=e);c.visibility!==r.group.visibility&&c.attr({visibility:r.group.visibility})}e=p(a.xValue)?h.toPixels(a.xValue+h.minPointOffset)-h.minPixelPadding:a.x;k=p(a.yValue)?z.toPixels(a.yValue):a.y;if(!isNaN(e)&&!isNaN(k)&&n(e)&&n(k)){b&&(b.attr(a.title),b.css(a.title.style));
if(q){b=x({},a.shape.params);if("values"===a.units){for(g in b)-1<y(g,["width","x"])?b[g]=h.translate(b[g]):-1<y(g,["height","y"])&&(b[g]=z.translate(b[g]));b.width&&(b.width-=h.toPixels(0)-h.left);b.x&&(b.x+=h.minPixelPadding);if("path"===a.shape.type){var g=b.d;r=e;for(var t=k,u=g.length,l=0;l<u;)"number"===typeof g[l]&&"number"===typeof g[l+1]?(g[l]=h.toPixels(g[l])-r,g[l+1]=z.toPixels(g[l+1])-t,l+=2):l+=1}}"circle"===a.shape.type&&(b.x+=b.r,b.y+=b.r);q.attr(b)}c.bBox=null;if(!n(m)){var w=c.getBBox();
m=w.width}n(A)||(w||(w=c.getBBox()),A=w.height);n(C)||(C=v.center);n(B)||(B=v.center);e-=m*C;k-=A*B;d.animation&&p(c.translateX)&&p(c.translateY)?c.animate({translateX:e,translateY:k}):c.translate(e,k)}},destroy:function(){var a=this,d=this.chart.annotations.allItems,c=d.indexOf(a);-1<c&&d.splice(c,1);u(["title","shape","group"],function(b){a[b]&&(a[b].destroy(),a[b]=null)});a.group=a.title=a.shape=a.chart=a.options=null},update:function(a,d){x(this.options,a);this.linkObjects();this.render(d)},linkObjects:function(){var a=
this.chart,d=this.linkedObject,c=d&&(d.id||d.options.id),b=this.options.linkedTo;p(b)?p(d)&&b===c||(this.linkedObject=a.get(b)):this.linkedObject=null}};x(t.prototype,{annotations:{add:function(a,d){var c=this.allItems,b=this.chart,f;"[object Array]"!==Object.prototype.toString.call(a)&&(a=[a]);for(f=a.length;f--;){var e=new E(b,a[f]);c.push(e);e.render(d)}},redraw:function(){u(this.allItems,function(a){a.redraw()})}}});t.prototype.callbacks.push(function(a){var d=a.options.annotations;var c=a.renderer.g("annotations");
c.attr({zIndex:7});c.add();a.annotations.allItems=[];a.annotations.chart=a;a.annotations.group=c;"[object Array]"===Object.prototype.toString.call(d)&&0<d.length&&a.annotations.add(a.options.annotations);f.addEvent(a,"redraw",function(){a.annotations.redraw()})})})(Highcharts,HighchartsAdapter);
