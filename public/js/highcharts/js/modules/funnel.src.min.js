/*
 
 Highcharts funnel module

 (c) 2010-2014 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(b){var y=b.getOptions().plotOptions,t=b.seriesTypes,H=b.merge,D=function(){},E=b.each;y.funnel=H(y.pie,{center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",dataLabels:{connectorWidth:1,connectorColor:"#606060"},size:!0,states:{select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}}});t.funnel=b.extendClass(t.pie,{type:"funnel",animate:D,translate:function(){var a=function(m,a){return/%$/.test(m)?a*parseInt(m,10)/100:parseInt(m,10)},g=0,e=this.chart,f=e.plotWidth;
e=e.plotHeight;var h=0,c=this.options,G=c.center,d=a(G[0],f),b=a(G[0],e),t=a(c.width,f),k,u,l=a(c.height,e),v=a(c.neckWidth,f),w=a(c.neckHeight,e),z=l-w;a=this.data;var A,B,y="left"===c.dataLabels.position?1:0,C,p,F,q,n,x,r;this.getWidthAt=u=function(m){return m>l-w||l===w?v:v+(l-w-m)/(l-w)*(t-v)};this.getX=function(m,a){return d+(a?-1:1)*(u(m)/2+c.dataLabels.distance)};this.center=[d,b,l];this.centerX=d;E(a,function(a){g+=a.y});E(a,function(a){r=null;B=g?a.y/g:0;p=b-l/2+h*l;n=p+B*l;k=u(p);C=d-k/
2;F=C+k;k=u(n);q=d-k/2;x=q+k;p>z?(C=q=d-v/2,F=x=d+v/2):n>z&&(r=n,k=u(z),q=d-k/2,x=q+k,n=z);A=["M",C,p,"L",F,p,x,n];r&&A.push(x,r,q,r);A.push(q,n,"Z");a.shapeType="path";a.shapeArgs={d:A};a.percentage=100*B;a.plotX=d;a.plotY=(p+(r||n))/2;a.tooltipPos=[d,a.plotY];a.slice=D;a.half=y;h+=B});this.setTooltipPoints()},drawPoints:function(){var a=this,g=a.options,e=a.chart.renderer;E(a.data,function(f){var h=f.graphic,c=f.shapeArgs;h?h.animate(c):f.graphic=e.path(c).attr({fill:f.color,stroke:g.borderColor,
"stroke-width":g.borderWidth}).add(a.group)})},sortByAngle:D,drawDataLabels:function(){var a=this.data,g=this.options.dataLabels.distance,e,f=a.length;for(this.center[2]-=2*g;f--;){var h=a[f];var c=(e=h.half)?1:-1;var b=h.plotY;var d=this.getX(b,e);h.labelPos=[0,b,d+(g-5)*c,b,d+g*c,b,e?"right":"left",0]}t.pie.prototype.drawDataLabels.call(this)}})})(Highcharts);
