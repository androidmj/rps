$(document).ready(function(){var a=$(".place-order-button, #checkout-icon");a.off("click").on("click",function(){$("#order-success-msg").html("").hide();$("#place-order-pop-title").html("Place Order");var a=$("#order-overlay");a.find(".bodyView").show();a.show().addClass("overlayViewOgm").addClass("active",{duration:200});bodyFreeze();$.post("ogmhelper.php",{ogm:"cmow"},function(a){a=$.parseJSON(a);""!=a.message?$("#order-error").html(a.message):$("#order-error").html("")});a=1;"checkout-icon"!=$(this).attr("id")&&
(a=0);$.post("ogmhelper.php",{ogm:"cart_view",no_add:a,pickup:$(this).data("pickup")},function(a){$("#cart_table_view").html(a);$("#order-details").show();refreshCartNumber()})});$(".show-cart").on("click",function(){showCart()});$(".add-to-cart-button").off("click").on("click",function(){var a=$(this);a.off("click");var d=a.data("mid"),e=1==$(this).data("pickup")?1:0;$.post("addtocart.php",{mid:d,num:1,pickup:e},function(b){b=$.parseJSON(b);"success"!=b.message?"Not logged in"==b.message?$(".place-order-button").first().click():
$("#order-error").html(b.message):($("#order-error").html(""),setCartNumber(b.data),a.hide(),$('.added-to-cart[data-mid="'+d+'"]').show())})});$(".close.right").off("click").on("click",function(){var a=$("#order-overlay");a.find(".bodyView").hide("fast");bodyUnfreeze();a.removeClass("active",{duration:200}).removeClass("overlayViewOgm").hide();history.back()});$("#order-total");$("#place-order").off("click").on("click",function(){var a=$("#order-error");if("none"==$("#cc-info").css("display"))a.html("Please add a payment method.");
else{var d=$(this),e=$("#po-load-div");a.html("");d.hide();e.show();$.post("placeorder.php",{pid:1,mid:1,num:1},function(b){b=$.parseJSON(b);e.hide();"success"==b.message?($("#order-details").hide(),$("#order-success-msg").html(b.data).show(),$("#place-order-pop-title").html(b.title),setCartNumber(0)):(a.html(b.message),d.show())})}});$(window).on("hashchange",function(){"#modalOpen"!=window.location.hash&&$("#order-overlay").hide()});firstLoad=!0;a.on("click",function(a){firstLoad&&getParameterByName("o")&&
window.history.pushState({t:1},"t","");firstLoad=!1;window.location.hash="#modalOpen"});refreshCartNumber()});function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}
function removeMeal(a,f,d){$(a).hide();$.post("addtocart.php",{mid:f,pickup:d},function(a){a=$.parseJSON(a);console.log(a);if("success"!=a.message)$("#order-error").html(a.message);else{var b,c=0,g;$("#order-error").html("");setCartNumber(a.data);$(".meal_row_"+f+"_"+d).remove();$(".chg-qty").each(function(a){g=$(this).data("mid");b=$(this).val()*$(this).data("price");$(".option_price_"+g).html(b.toFixed(2));c+=b});rewardDollars=parseFloat($("#reward_dollars").text());rewardDollars>=c?$("#reward_dollars_shown").html(c.toFixed(2)):
$("#reward_dollars_shown").html(rewardDollars.toFixed(2));$("#order-subtotal").html(c.toFixed(2));c=Math.max(c-rewardDollars,0);a=.0625*c;$("#order-tax").html(a.toFixed(2));$("#order-total").html((c+a).toFixed(2))}})}function refreshCartNumber(){$.post("ogmhelper.php",{ogm:"refresh_cart"},function(a){a=$.parseJSON(a).data;!isNaN(parseFloat(a))&&isFinite(a)&&$(".items-in-cart").html(a)})}function setCartNumber(a){$(".items-in-cart").html(a)}
function showCart(){var a=$("#checkout-icon");a.length?a.click():$(".place-order-button").first().click()}function bodyFreeze(){$("body").addClass("noscroll")}function bodyUnfreeze(){$("body").removeClass("noscroll")};
